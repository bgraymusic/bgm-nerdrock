AWSTemplateFormatVersion: '2010-09-09'
Description: Nerdrock Website Deployment Configuration
Parameters:
  Org:
    Type: String
  Project:
    Type: String
  Stage:
    Type: String
Resources:
  BadgesLambda:
    Type: bgm::nerdrock::lambda::MODULE
    Properties:
      Org: !Sub ${Org}
      Project: !Sub ${Project}
      Stage: !Sub ${Stage}
      LambdaName: badges

  DiscographyLambda:
    Type: bgm::nerdrock::lambda::MODULE
    Properties:
      Org: !Sub ${Org}
      Project: !Sub ${Project}
      Stage: !Sub ${Stage}
      LambdaName: discography

  DatabaseRefreshLambda:
    Type: bgm::nerdrock::lambda::MODULE
    Properties:
      Org: !Sub ${Org}
      Project: !Sub ${Project}
      Stage: !Sub ${Stage}
      LambdaName: databaseRefresh

  NerdrockWebsite:
    Type: bgm::nerdrock::s3website::MODULE
    Properties:
      Org: !Sub ${Org}
      Project: !Sub ${Project}
      Stage: !Sub ${Stage}

  AlbumInfoTable:
    Type: AWS::DynamoDB::Table
    Properties:
      TableName: !Sub $(Org)-$(Project)-$(Stage)-albuminfo
      AttributeDefinitions:
        - AttributeName: album_id
          AttributeType: 'N'
      KeySchema:
        - AttributeName: album_id
          KeyType: HASH
      ProvisionedThroughput:
        ReadCapacityUnits: 5
        WriteCapacityUnits: 5

  TrackInfoTable:
    Type: AWS::DynamoDB::Table
    Properties:
      TableName: !Sub $(Org)-$(Project)-$(Stage)-trackinfo
      AttributeDefinitions:
        - AttributeName: album_id
          AttributeType: 'N'
        - AttributeName: number
          AttributeType: 'N'
      KeySchema:
        - AttributeName: album_id
          KeyType: HASH
        - AttributeName: number
          KeyType: RANGE
      ProvisionedThroughput:
        ReadCapacityUnits: 5
        WriteCapacityUnits: 5

  ResourceGroup:
    Type: bgm::nerdrock::resourcegroup::MODULE
    Properties:
      Org: !Sub ${Org}
      Project: !Sub ${Project}
      Stage: !Sub ${Stage}
